{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    ":dependencyDashboard",
    ":semanticCommits",
    ":separateMajorReleases"
  ],
  "schedule": ["before 10am on monday"],
  "timezone": "UTC",
  "labels": ["dependencies"],
  "assignees": ["@shahrozali"],
  "reviewers": ["@shahrozali"],
  "prConcurrentLimit": 3,
  "prHourlyLimit": 2,
  "stabilityDays": 1,
  "minimumReleaseAge": "1 day",
  "packageRules": [
    {
      "description": "Auto-merge patch and minor updates after verification",
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "pr",
      "automergeStrategy": "squash",
      "platformAutomerge": true,
      "requiredStatusChecks": null
    },
    {
      "description": "Major updates require manual review",
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "dependencyDashboard": true,
      "addLabels": ["major-update", "breaking-change"]
    },
    {
      "description": "Group Android/Compose BOM updates",
      "matchPackageNames": [
        "androidx.compose:compose-bom",
        "androidx.compose:compose-bom-alpha",
        "androidx.compose:compose-bom-beta"
      ],
      "groupName": "Compose BOM",
      "automerge": false,
      "addLabels": ["compose-bom"]
    },
    {
      "description": "Group Kotlin updates",
      "matchPackageNames": [
        "org.jetbrains.kotlin:kotlin-gradle-plugin",
        "org.jetbrains.kotlin:kotlin-stdlib",
        "org.jetbrains.kotlinx:kotlinx-coroutines-core"
      ],
      "groupName": "Kotlin",
      "addLabels": ["kotlin"]
    },
    {
      "description": "Group Android Gradle Plugin updates",
      "matchPackageNames": ["com.android.tools.build:gradle"],
      "groupName": "Android Gradle Plugin",
      "automerge": false,
      "addLabels": ["android-gradle-plugin"]
    },
    {
      "description": "Security updates get immediate attention",
      "matchDatasources": ["maven"],
      "vulnerabilityAlerts": {
        "enabled": true
      },
      "automerge": true,
      "addLabels": ["security"]
    }
  ],
  "postUpgradeTasks": {
    "commands": [
      "echo 'üß™ Running tests...'",
      "./gradlew clean test --no-daemon",
      "echo 'üì± Building sample apps...'", 
      "./gradlew :samples:kotlin_compose:assembleDebug --no-daemon",
      "./gradlew :samples:java_layout:assembleDebug --no-daemon"
    ],
    "fileFilters": ["**/*"],
    "executionMode": "branch"
  },
  "gradle": {
    "timeout": 600
  },
  "java": {
    "ignoreDeps": []
  },
  "maven": {
    "registryUrls": [
      "https://repo1.maven.org/maven2",
      "https://jcenter.bintray.com",
      "https://maven.google.com"
    ]
  },
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update version constants in Versions.kt",
      "fileMatch": ["buildSrc/src/main/kotlin/io.customer/android/Versions.kt"],
      "matchStrings": [
        "internal const val (?<depName>[A-Z_]+) = \"(?<currentValue>[^\"]+)\""
      ],
      "datasourceTemplate": "maven",
      "registryUrlTemplate": "https://repo1.maven.org/maven2"
    }
  ],
  "prBodyTemplate": "## üîÑ Dependency Update\n\nThis PR updates dependencies in the Customer.io Android SDK.\n\n### üì¶ Changes\n{{{changelogs}}}\n\n### ‚úÖ Verification\n- [x] Clean build successful\n- [x] Unit tests passing\n- [x] Sample apps compile successfully\n\n### üîç Notes\n{{{notes}}}\n\n---\n*Automated by Renovate*"
} 